name: Generar PDF de todos los README

on:
  push:
    branches:
      - main

jobs:
  generate-pdfs:
    runs-on: ubuntu-latest

    steps:
    - name: Chequear repositorio
      uses: actions/checkout@v3
      with:
        persist-credentials: true

    - name: Instalar Pandoc y LaTeX
      run: |
        sudo apt-get update
        sudo apt-get install -y pandoc texlive-xetex texlive-fonts-recommended texlive-latex-recommended

    - name: Buscar y convertir todos los README.md a PDF
      run: |
        find . -name "README.md" | while read file; do
          echo "Generando PDF para $file"
          dir=$(dirname "$file")
          base=$(basename "$file" .md)
          pandoc "$file" -o "$dir/$base.pdf"
        done

    - name: Hacer commit de los PDFs
      run: |
        git config --local user.name "github-actions[bot]"
        git config --local user.email "github-actions[bot]@users.noreply.github.com"
        git add $(find . -name "README.pdf")
        git commit -m "Actualizar PDFs de README" || echo "No hay cambios"
        git push
